Задание выполнено. Потратил много времени поиск и обработку возможных исключений. Временами путался в порядке написания нодов. С дебагом все довольно легко исправлялось, но времени тоже отняло прилично. 